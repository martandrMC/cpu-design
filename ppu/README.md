# Puny Processing Unit

### Overview

The Puny Processing Unit is a minimal Turning-complete harvard architecture with a data word size of 8 bits and an instruction word size of 10 bits. It can address a maximum of 64 instruction words and 16 data words of memory.

## Register System

The processor has 4 general purpose registers ( *A*, *B*, *C*, and *D* ) and can select up to 2 of them in each instruction. Unlike other systems where one of the two registers specified is used both as a source and a destination, the PPU uses one register as the destination, one as a source, and for binary operations like addition the second source is implied to be register A. Unary operations like bit shifts do not need a second source.  
  
There also exist 2 special purpose registers, the PC ( *Program Counter* )  that keeps track of the currently executing instruction, and the flags register that holds metadata about calculation results that get used as conditions for branching. The PC can be read through a dedicated instruction and get stored in a general purpose register but the flags register can not.

## Architecture

### Instruction Parts

The instruction words are broken up into 2-bit parts each of which can be one of 3 types :
- ***Operation Code*** : Determines the specific instruction to be performed. Has a size of 4 bits or 6 bits.
- ***Register Address*** : Indicates with which of the 4 registers the instruction will operate. Always 2 bits.
- ***Immediate*** : Contains data to be used in the instruction directly. Has a size of 4 bits or 6 bits.

### Instruction Groups

The instructions themselves can be one of 4 types, categorised based on which of the above parts are used ( MSB First ) :
- ***S Type*** : Consists of 2 opcode parts followed by 1 register part and 2 immediate parts. Register part can indicate both a source and a destination of data. Used by load/store instructions to address the data memory or by immediate arithmetic instructions.
- ***L Type*** : Consists of 2 opcode parts followed by 3 immediate parts. Used by branch instructions to address the program memory.
- ***R Type*** : Consists of 3 opcode parts followed by 2 register parts. The first one is always the destination and the second always the source. Both can be omitted depending on the specific instruction. Mostly used by register arithmetic instructions.
- ***N Type*** : Consists of 2 opcode parts only. The rest of the 6 bits are left unused. Used by the NOP and HLT instructions.

### Register Useages

- ***Program Counter*** : Points to currently executing instruction. Can be via branch instructions.
- ***Flags Register*** : Holds flags from the last executed ALU operation. Can not be directly acessed.
- ***A Register*** : The implied second source register.
- ***B Register*** : The only register that can be used to address data memory.
- ***C Register*** : General purpose register.
- ***D Register*** : General purpose register. ( *Recommended register for holding function return addresses.* )

### Flags

Flags are stored in their own specific register and are generated by the ALU. There exist 4 in total :
- ***True*** : Will always be 1. Allows for unconditional jumps.
- ***Zero*** : Set when the ALU's result is equal to 0. Reset otherwise.
- ***Carry*** : Set when the ALU's result can not fit in 8 bits ( *unsigned* ) or contains the bit that a shift instruction removed.
- ***Overflow*** : Set when the ALU's result can not fit in 8 bits ( *signed* ) .

## Instruction List

Google Sheets [document](https://docs.google.com/spreadsheets/d/1_gcTCpBKGeM89a37Rxb8PIeris02Dp2Df4ftqjP5rlE/edit?usp=sharing). ( *Outdated Terminology* )